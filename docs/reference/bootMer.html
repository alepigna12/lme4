<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Perform model-based (Semi-)parametric bootstrap for mixed
  models."><title>Model-based (Semi-)Parametric Bootstrap for Mixed Models — bootMer • lme4</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.5/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.5/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.5/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model-based (Semi-)Parametric Bootstrap for Mixed Models — bootMer"><meta property="og:description" content="Perform model-based (Semi-)parametric bootstrap for mixed
  models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lme4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-35.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/exampleanalysis.html">Example Analysis</a>
    <a class="dropdown-item" href="../articles/lmerperf.html">lme4 performance tips</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lme4/lme4/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Model-based (Semi-)Parametric Bootstrap for Mixed Models</h1>
      
      <div class="d-none name"><code>bootMer.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform model-based (Semi-)parametric bootstrap for mixed
  models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bootMer</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, nsim <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, use.u <span class="op">=</span> <span class="cn">FALSE</span>, re.form<span class="op">=</span><span class="cn">NA</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parametric"</span>, <span class="st">"semiparametric"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>, .progress <span class="op">=</span> <span class="st">"none"</span>, PBargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"multicore"</span>, <span class="st">"snow"</span><span class="op">)</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"boot.ncpus"</span>, <span class="fl">1L</span><span class="op">)</span>, cl <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a fitted <code>merMod</code> object: see
    <code><a href="lmer.html">lmer</a></code>, <code><a href="glmer.html">glmer</a></code>, etc.</p></dd>

  <dt>FUN</dt>
<dd><p>a function taking a fitted
    <code>merMod</code> object as input and returning the
    <em>statistic</em> of interest, which must be a (possibly named)
    numeric vector.</p></dd>

  <dt>nsim</dt>
<dd><p>number of simulations, positive integer; the
    bootstrap \(B\) (or \(R\)).</p></dd>

  <dt>seed</dt>
<dd><p>optional argument to <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code>.</p></dd>

  <dt>use.u</dt>
<dd><p>logical, indicating whether the spherical
    random effects should be simulated / bootstrapped as
    well.  If <code>TRUE</code>, they are not changed, and all
    inference is conditional on these values. If
    <code>FALSE</code>, new normal deviates are drawn (see
    Details).</p></dd>

  <dt>re.form</dt>
<dd><p>formula, <code>NA</code> (equivalent to <code>use.u=FALSE</code>),
    or <code>NULL</code> (equivalent to <code>use.u=TRUE</code>):
    alternative to <code>use.u</code> for
    specifying which random effects to incorporate.
    See <code><a href="simulate.merMod.html">simulate.merMod</a></code> for details.</p></dd>

  <dt>type</dt>
<dd><p>character string specifying the type of
    bootstrap, <code>"parametric"</code> or
    <code>"semiparametric"</code>; partial matching is allowed.</p></dd>

  <dt>verbose</dt>
<dd><p>logical indicating if progress should
    print output</p></dd>

  <dt>.progress</dt>
<dd><p>character string - type of progress bar
    to display.  Default is <code>"none"</code>; the function will
    look for a relevant <code>*ProgressBar</code> function, so
    <code>"txt"</code> will work in general; <code>"tk"</code> is
    available if the <span class="pkg">tcltk</span> package is loaded; or
    <code>"win"</code> on Windows systems. Progress bars are
    disabled (with a message) for parallel operation.</p></dd>

  <dt>PBargs</dt>
<dd><p>a list of additional arguments to the
    progress bar function (the package authors like
    <code>list(style=3)</code>).</p></dd>

  <dt>parallel</dt>
<dd><p>The type of parallel operation to be used (if any).
    If missing, the
    default is taken from the option <code>"boot.parallel"</code> (and if that
    is not set, <code>"no"</code>).</p></dd>

  <dt>ncpus</dt>
<dd><p>integer: number of processes to be used in parallel operation:
    typically one would choose this to be the number of available CPUs.</p></dd>

  <dt>cl</dt>
<dd><p>An optional <span class="pkg">parallel</span> or <span class="pkg">snow</span> cluster for use if
    <code>parallel = "snow"</code>.  If not supplied, a cluster on the
    local machine is created for the duration of the <code>boot</code> call.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an object of S3 <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></code></p>
<p></p>
<p><code>"boot"</code>,
  compatible with <a href="https://CRAN.R-project.org/package=boot" class="external-link"><span class="pkg">boot</span></a> package's</p>
<p></p>
<p><code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot</a>()</code> result. (See Details for information on how
  to retrieve information about errors during bootstrapping.)</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If you are using <code>parallel="snow"</code>, you will need to run
  <code>clusterEvalQ(cl,library("lme4"))</code> before calling
  <code>bootMer</code> to make sure that the
  <code>lme4</code> package is loaded on all of the workers; you may
  additionally need to use <code><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterExport</a></code>
  if you are using a summary function that calls any objects
  from the environment.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The semi-parametric variant is only partially implemented, and
  we only provide a method for <code><a href="lmer.html">lmer</a></code> and
  <code><a href="glmer.html">glmer</a></code> results.</p>  
<p>Information about warning and error messages incurred during the
  bootstrap returns can be retrieved via the attributes</p><dl><dt>bootFail</dt>
<dd><p>number of failures (errors)</p></dd>

  <dt>boot.fail.msgs</dt>
<dd><p>error messages</p></dd>

  <dt>boot.all.msgs</dt>
<dd><p>messages, warnings, and error messages</p></dd>


</dl><p>e.g. <code>attr("boot.fail.msgs")</code> to retrieve error messages</p>
<p>The working name for bootMer() was
  “simulestimate()”, as it is an extension of <code>simulate</code>
  (see <a href="simulate.merMod.html">simulate.merMod</a>), but we want to emphasize its potential
  for valid inference.</p><ul><li><p>If <code>use.u</code> is <code>FALSE</code> and <code>type</code> is
    <code>"parametric"</code>, each simulation generates new values of both
    the “<em>spherical</em>” random effects \(u\) and the
    i.i.d. errors \(\epsilon\), using <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a>()</code>
    with parameters corresponding to the fitted model <code>x</code>.</p></li>
<li><p>If <code>use.u</code> is <code>TRUE</code> and <code>type=="parametric"</code>,
    only the i.i.d. errors (or, for GLMMs, response values drawn from
    the appropriate distributions) are resampled, with the values of
    \(u\) staying fixed at their estimated values.</p></li>
<li><p>If <code>use.u</code> is <code>TRUE</code> and <code>type=="semiparametric"</code>,
    the i.i.d. errors are sampled from the distribution of (response)
    residuals.  (For GLMMs, the resulting
    sample will no longer have the same properties as the original
    sample, and the method may not make sense; a warning is generated.)
    The semiparametric bootstrap is currently an experimental feature,
    and therefore may not be stable.</p></li>
<li><p>The case where <code>use.u</code> is <code>FALSE</code> and
    <code>type=="semiparametric"</code> is not implemented; Morris (2002)
    suggests that resampling from the estimated values of \(u\) is not
    good practice.</p></li>
</ul><p><!-- %% itemize --></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Davison, A.C. and Hinkley, D.V. (1997)
  <em>Bootstrap Methods and Their Application</em>.
  Cambridge University Press.</p>
<p>Morris, J. S. (2002).
  The BLUPs Are Not ‘best’ When It Comes to Bootstrapping.
  <em>Statistics &amp; Probability Letters</em> <b>56</b>(4): 425--430.
  doi:10.1016/S0167-7152(02)00041-X.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p></p><ul><li><p><code><a href="confint.merMod.html">confint.merMod</a></code>,
    for a more specific approach to bootstrap confidence
    intervals on parameters.</p></li>
<li><p><code><a href="refit.html">refit</a>()</code>, or <code><a href="https://rdrr.io/pkg/pbkrtest/man/pb-modcomp.html" class="external-link">PBmodcomp</a>()</code>
    from the <a href="https://CRAN.R-project.org/package=pbkrtest" class="external-link"><span class="pkg">pbkrtest</span></a> package, for parametric bootstrap comparison
    of models.</p></li>
<li><p><code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot</a>()</code>, and then
    <code><a href="https://rdrr.io/pkg/boot/man/boot.ci.html" class="external-link">boot.ci</a></code>, from the <span class="pkg">boot</span> package.</p></li>
<li><p><code><a href="profile-methods.html">profile-methods</a></code>, for likelihood-based inference,
    including confidence intervals.</p></li>
<li><p><code><a href="pvalues.html">pvalues</a></code>,
    for more general approaches to inference and p-value computation
    in mixed models.</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fm01ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="lmer.html">lmer</a></span><span class="op">(</span><span class="va">Yield</span> <span class="op">~</span> <span class="fl">1</span><span class="op">|</span><span class="va">Batch</span>, <span class="va">Dyestuff</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## see ?"profile-methods"</span></span></span>
<span class="r-in"><span><span class="va">mySumm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">{</span> <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="sigma.html">sigma</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>beta <span class="op">=</span><span class="fu"><a href="getME.html">getME</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"beta"</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">s</span>, sig01 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">s</span> <span class="op">*</span> <span class="fu"><a href="getME.html">getME</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"theta"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu">mySumm</span><span class="op">(</span><span class="va">fm01ML</span><span class="op">)</span><span class="op">)</span> <span class="co"># just three parameters</span></span></span>
<span class="r-in"><span><span class="co">## alternatively:</span></span></span>
<span class="r-in"><span><span class="va">mySumm2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="fixef.html">fixef</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,sigma<span class="op">=</span><span class="fu"><a href="sigma.html">sigma</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, sig01<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="VarCorr.html">VarCorr</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## 3.8s (on a 5600 MIPS 64bit fast(year 2009) desktop "AMD Phenom(tm) II X4 925"):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span> <span class="va">boo01</span> <span class="op">&lt;-</span> <span class="fu">bootMer</span><span class="op">(</span><span class="va">fm01ML</span>, <span class="va">mySumm</span>, nsim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## to "look" at it</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"boot"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">boo01</span></span></span>
<span class="r-in"><span>    <span class="co">## note large estimated bias for sig01</span></span></span>
<span class="r-in"><span>    <span class="co">## (~30% low, decreases _slightly_ for nsim = 1000)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## extract the bootstrapped values as a data frame ...</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">boo01</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## ------ Bootstrap-based confidence intervals ------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## warnings about "Some ... intervals may be unstable" go away</span></span></span>
<span class="r-in"><span>    <span class="co">##   for larger bootstrap samples, e.g. nsim=500</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## intercept</span></span></span>
<span class="r-in"><span>    <span class="op">(</span><span class="va">bCI.1</span> <span class="op">&lt;-</span> <span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html" class="external-link">boot.ci</a></span><span class="op">(</span><span class="va">boo01</span>, index<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"basic"</span>, <span class="st">"perc"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="co"># beta</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Residual standard deviation - original scale:</span></span></span>
<span class="r-in"><span>    <span class="op">(</span><span class="va">bCI.2</span>  <span class="op">&lt;-</span> <span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html" class="external-link">boot.ci</a></span><span class="op">(</span><span class="va">boo01</span>, index<span class="op">=</span><span class="fl">2</span>, type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"basic"</span>, <span class="st">"perc"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## Residual SD - transform to log scale:</span></span></span>
<span class="r-in"><span>    <span class="op">(</span><span class="va">bCI.2L</span> <span class="op">&lt;-</span> <span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html" class="external-link">boot.ci</a></span><span class="op">(</span><span class="va">boo01</span>, index<span class="op">=</span><span class="fl">2</span>, type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"basic"</span>, <span class="st">"perc"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       h <span class="op">=</span> <span class="va">log</span>, hdot <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="va">.</span>, hinv <span class="op">=</span> <span class="va">exp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Among-batch variance:</span></span></span>
<span class="r-in"><span>    <span class="op">(</span><span class="va">bCI.3</span> <span class="op">&lt;-</span> <span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html" class="external-link">boot.ci</a></span><span class="op">(</span><span class="va">boo01</span>, index<span class="op">=</span><span class="fl">3</span>, type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"basic"</span>, <span class="st">"perc"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># sig01</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">boo01</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">boo01</span>,type<span class="op">=</span><span class="st">"norm"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">boo01</span>,type<span class="op">=</span><span class="st">"basic"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Graphical examination:</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boo01</span>,index<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Check stored values from a longer (1000-replicate) run:</span></span></span>
<span class="r-in"><span>    <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata"</span>,<span class="st">"boo01L.RData"</span>, package<span class="op">=</span><span class="st">"lme4"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="co"># "boo01L"</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boo01L</span>, index<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">boo01L</span><span class="op">$</span><span class="va">t</span><span class="op">[</span>,<span class="st">"sig01"</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="co">## note point mass at zero!</span></span></span>
<span class="r-in"><span><span class="op">}</span> </span></span>
<span class="r-in"><span><span class="op">}</span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Douglas Bates, Martin Maechler, Ben Bolker, Steven Walker.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

