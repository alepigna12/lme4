<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="[g]lmer fits may produce convergence warnings;
  these do not necessarily mean the fit is incorrect (see
  &amp;#8220;Theoretical details&amp;#8221; below). The following steps are recommended
  assessing and resolving convergence warnings
  (also see examples below):

double-check the model specification and the data
adjust stopping (convergence) tolerances for the nonlinear optimizer,
    using the optCtrl argument to [g]lmerControl
    (see &amp;#8220;Convergence controls&amp;#8221; below)
center and scale continuous predictor variables (e.g. with scale)
double-check the Hessian calculation with the more expensive
    Richardson extrapolation method (see examples)
restart the fit from the reported optimum, or from a point
    perturbed slightly away from the reported optimum
use allFit to try the fit with all available optimizers (e.g. several different implementations
    of BOBYQA and Nelder-Mead, L-BFGS-B from optim, nlminb,
    ...).  While this will of course be slow for large fits, we consider
    it the gold standard; if all optimizers converge to values that
    are practically equivalent, then we would consider the convergence
    warnings to be false positives.
"><title>Assessing Convergence for Fitted Models — convergence • lme4</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assessing Convergence for Fitted Models — convergence"><meta property="og:description" content="[g]lmer fits may produce convergence warnings;
  these do not necessarily mean the fit is incorrect (see
  &amp;#8220;Theoretical details&amp;#8221; below). The following steps are recommended
  assessing and resolving convergence warnings
  (also see examples below):

double-check the model specification and the data
adjust stopping (convergence) tolerances for the nonlinear optimizer,
    using the optCtrl argument to [g]lmerControl
    (see &amp;#8220;Convergence controls&amp;#8221; below)
center and scale continuous predictor variables (e.g. with scale)
double-check the Hessian calculation with the more expensive
    Richardson extrapolation method (see examples)
restart the fit from the reported optimum, or from a point
    perturbed slightly away from the reported optimum
use allFit to try the fit with all available optimizers (e.g. several different implementations
    of BOBYQA and Nelder-Mead, L-BFGS-B from optim, nlminb,
    ...).  While this will of course be slow for large fits, we consider
    it the gold standard; if all optimizers converge to values that
    are practically equivalent, then we would consider the convergence
    warnings to be false positives.
"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lme4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-35.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/lmerperf.html">lme4 performance tips</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lme4/lme4/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Assessing Convergence for Fitted Models</h1>
      
      <div class="d-none name"><code>convergence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>[g]lmer</code> fits may produce convergence warnings;
  these do <strong>not</strong> necessarily mean the fit is incorrect (see
  “Theoretical details” below). The following steps are recommended
  assessing and resolving convergence warnings
  (also see examples below):</p>
<p></p><ul><li><p>double-check the model specification and the data</p></li>
<li><p>adjust stopping (convergence) tolerances for the nonlinear optimizer,
    using the <code>optCtrl</code> argument to <code>[g]lmerControl</code>
    (see “Convergence controls” below)</p></li>
<li><p>center and scale continuous predictor variables (e.g. with <code><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></code>)</p></li>
<li><p>double-check the Hessian calculation with the more expensive
    Richardson extrapolation method (see examples)</p></li>
<li><p>restart the fit from the reported optimum, or from a point
    perturbed slightly away from the reported optimum</p></li>
<li><p>use <code><a href="allFit.html">allFit</a></code> to try the fit with all available optimizers (e.g. several different implementations
    of BOBYQA and Nelder-Mead, L-BFGS-B from <code>optim</code>, <code>nlminb</code>,
    ...).  While this will of course be slow for large fits, we consider
    it the gold standard; if all optimizers converge to values that
    are practically equivalent, then we would consider the convergence
    warnings to be false positives.</p></li>
</ul><p><!-- % end itemize --></p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p></p><div class="section">
<h3 id="convergence-controls">Convergence controls<a class="anchor" aria-label="anchor" href="#convergence-controls"></a></h3>
<p></p><ul><li><p>the controls for the <code>nloptwrap</code> optimizer (the default
  for <code>lmer</code>) are</p><dl><dt>ftol_abs</dt>
<dd><p>(default 1e-6) stop on small change in deviance</p></dd>

	<dt>ftol_rel</dt>
<dd><p>(default 0) stop on small relative change in deviance</p></dd>

	<dt>xtol_abs</dt>
<dd><p>(default 1e-6) stop on small change of parameter values</p></dd>

	<dt>xtol_rel</dt>
<dd><p>(default 0) stop on small relative change of
	  parameter values</p></dd>

	<dt>maxeval</dt>
<dd><p>(default 1000) maximum number of function evaluations</p></dd>

      
</dl><p>Changing <code>ftol_abs</code> and <code>xtol_abs</code> to stricter values
      (e.g. 1e-8) is a good first step for resolving convergence
      problems, at the cost of slowing down model fits.</p></li>
<li><p>the controls for <code><a href="https://rdrr.io/pkg/minqa/man/bobyqa.html" class="external-link">minqa::bobyqa</a></code> (default for
      <code>glmer</code> first-stage optimization) are</p><dl><dt>rhobeg</dt>
<dd><p>(default 2e-3) initial radius of the trust region</p></dd>

	<dt>rhoend</dt>
<dd><p>(default 2e-7) final radius of the trust region</p></dd>

	<dt>maxfun</dt>
<dd><p>(default 10000) maximum number of function evaluations</p></dd>

      
</dl><p><code>rhoend</code>, which describes the scale of parameter uncertainty
      on convergence, is approximately analogous to <code>xtol_abs</code>.</p></li>
<li><p>the controls for <code>Nelder_Mead</code> (default for
      <code>glmer</code> second-stage optimization) are</p><dl><dt>FtolAbs</dt>
<dd><p>(default 1e-5) stop on small change in deviance</p></dd>

	<dt>FtolRel</dt>
<dd><p>(default 1e-15) stop on small relative change in deviance</p></dd>

        <dt>XtolRel</dt>
<dd><p>(default 1e-7) stop on small change of parameter
	  values</p></dd>

	<dt>maxfun</dt>
<dd><p>(default 10000) maximum number of function evaluations</p></dd>

     
</dl><p><!-- % Nelder_Mead controls --></p></li>
</ul><p><!-- % list of optimizers --></p>
</div><p><!-- % convergence controls --></p> 
<div class="section">
<h3 id="theoretical-issues">Theoretical issues<a class="anchor" aria-label="anchor" href="#theoretical-issues"></a></h3>
<p><span class="pkg">lme4</span> uses general-purpose nonlinear optimizers
  (e.g. Nelder-Mead or Powell's BOBYQA method) to estimate the
  variance-covariance matrices of the random effects.  Assessing
  the convergence of such algorithms reliably is difficult.  For
  example, evaluating the
  <a href="https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions" class="external-link">Karush-Kuhn-Tucker conditions</a> (convergence criteria which
  reduce in simple cases to showing that
  the gradient is zero and the Hessian is positive definite) is
  challenging because of the difficulty of evaluating the gradient and
  Hessian.</p>
<p>We (the <code>lme4</code> authors and maintainers) are still in the process
  of finding the best strategies for testing convergence.  Some of the
  relevant issues are</p><ul><li><p>the gradient and Hessian are the basic ingredients of
    KKT-style testing, but (at least for now) <code>lme4</code> estimates
    them by finite-difference approximations which are sometimes
    unreliable.</p></li>
<li><p>The Hessian computation in particular represents
    a difficult tradeoff between computational expense and
    accuracy.  At present the Hessian computations used
    for convergence checking (and for estimating standard errors
    of fixed-effect parameters for GLMMs) follow the <a href="https://CRAN.R-project.org/package=ordinal" class="external-link"><span class="pkg">ordinal</span></a> package
    in using a naive but computationally cheap centered finite difference
    computation (with a fixed step size of \(10^{-4}\)).  A more
    reliable but more expensive approach is to use
    <a href="https://en.wikipedia.org/wiki/Richardson_extrapolation" class="external-link">Richardson extrapolation</a>,
    as implemented in the <a href="https://CRAN.R-project.org/package=numDeriv" class="external-link"><span class="pkg">numDeriv</span></a> package.</p></li>
<li><p>it is important to scale the estimated gradient at
    the estimate appropriately; two reasonable approaches are</p><ol><li><p>scale gradients by the inverse Cholesky factor of the
      Hessian, equivalent to scaling gradients by the
      estimated Wald standard error
      of the estimated parameters.  <code>lme4</code> uses this
      approach; it requires the Hessian to be estimated (although the Hessian is
      required <a href="https://github.com/lme4/lme4/issues/47" class="external-link">for
	reliable estimation of the fixed-effect standard errors for GLMMs</a>
      in any case).</p></li>
<li><p>use unscaled gradients on the random-effects parameters,
      since these are essentially already unitless (for LMMs they are scaled
      relative to the residual variance; for GLMMs they are scaled
      relative to the sampling variance of the conditional distribution);
      for GLMMs, scale fixed-effect gradients by the standard deviations
      of the corresponding input variable</p></li>
</ol></li>
<li><p>Exploratory analyses suggest that (1) the naive estimation
    of the Hessian may fail for large data sets (number of observations
    greater than approximately
    \(10^{5}\)); (2) the magnitude of the scaled
    gradient increases with sample size, so that warnings will occur
    even for apparently well-behaved fits with large data sets.</p></li>
</ul><p><!-- % itemize --></p>
</div><p><!-- % theoretical issues --></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="lmerControl.html">lmerControl</a></code>, <code><a href="isSingular.html">isSingular</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="lmer.html">lmer</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span> <span class="op">+</span> <span class="op">(</span><span class="va">Days</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span>, <span class="va">sleepstudy</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 1. decrease stopping tolerances</span></span></span>
<span class="r-in"><span><span class="va">strict_tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="lmerControl.html">lmerControl</a></span><span class="op">(</span>optCtrl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xtol_abs<span class="op">=</span><span class="fl">1e-8</span>, ftol_abs<span class="op">=</span><span class="fl">1e-8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">@</span><span class="va">optinfo</span><span class="op">$</span><span class="va">optimizer</span><span class="op">==</span><span class="st">"nloptwrap"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">fm1.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm1</span>, control<span class="op">=</span><span class="va">strict_tol</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2. center and scale predictors:</span></span></span>
<span class="r-in"><span><span class="va">ss.CS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">sleepstudy</span>, Days<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Days</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm1.CS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm1</span>, data<span class="op">=</span><span class="va">ss.CS</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 3. recompute gradient and Hessian with Richardson extrapolation</span></span></span>
<span class="r-in"><span><span class="va">devfun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm1</span>, devFunOnly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="isREML.html">isLMM</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="getME.html">getME</a></span><span class="op">(</span><span class="va">fm1</span>,<span class="st">"theta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co">## GLMM: requires both random and fixed parameters</span></span></span>
<span class="r-in"><span>    <span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="getME.html">getME</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"theta"</span>,<span class="st">"fixef"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="http://optimizer.r-forge.r-project.org/" class="external-link">"numDeriv"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"hess:\n"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">hess</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/hessian.html" class="external-link">hessian</a></span><span class="op">(</span><span class="va">devfun</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"grad:\n"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">grad</a></span><span class="op">(</span><span class="va">devfun</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"scaled gradient:\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scgrad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">hess</span><span class="op">)</span>, <span class="va">grad</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co">## compare with internal calculations:</span></span></span>
<span class="r-in"><span><span class="va">fm1</span><span class="op">@</span><span class="va">optinfo</span><span class="op">$</span><span class="va">derivs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## compute reciprocal condition number of Hessian</span></span></span>
<span class="r-in"><span><span class="va">H</span> <span class="op">&lt;-</span> <span class="va">fm1</span><span class="op">@</span><span class="va">optinfo</span><span class="op">$</span><span class="va">derivs</span><span class="op">$</span><span class="va">Hessian</span></span></span>
<span class="r-in"><span><span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rcond.html" class="external-link">rcond</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 4. restart the fit from the original value (or</span></span></span>
<span class="r-in"><span><span class="co">## a slightly perturbed value):</span></span></span>
<span class="r-in"><span><span class="va">fm1.restart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm1</span>, start<span class="op">=</span><span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span>,<span class="va">pars</span><span class="op">/</span><span class="fl">1.01</span>,<span class="va">pars</span><span class="op">*</span><span class="fl">1.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm1.restart2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm1</span>, start<span class="op">=</span><span class="va">pars_x</span>,</span></span>
<span class="r-in"><span>                       control<span class="op">=</span><span class="va">strict_tol</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 5. try all available optimizers</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">fm1.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="allFit.html">allFit</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fm1.all</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ss</span><span class="op">$</span> <span class="va">fixef</span>               <span class="co">## fixed effects</span></span></span>
<span class="r-in"><span>  <span class="va">ss</span><span class="op">$</span> <span class="va">llik</span>                <span class="co">## log-likelihoods</span></span></span>
<span class="r-in"><span>  <span class="va">ss</span><span class="op">$</span> <span class="va">sdcor</span>               <span class="co">## SDs and correlations</span></span></span>
<span class="r-in"><span>  <span class="va">ss</span><span class="op">$</span> <span class="va">theta</span>               <span class="co">## Cholesky factors</span></span></span>
<span class="r-in"><span>  <span class="va">ss</span><span class="op">$</span> <span class="va">which.OK</span>            <span class="co">## which fits worked</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Douglas Bates, Martin Maechler, Ben Bolker, Steven Walker.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

