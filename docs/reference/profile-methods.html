<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Methods for profile() of [ng]lmer fitted
  models.
The log() method and the more flexible logProf()
  utility transform a lmer profile into one where logarithms of standard deviations
  are used, while varianceProf converts from the
  standard-deviation to the variance scale; see Details."><title>Profile method for merMod objects — profile-methods • lme4</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Profile method for merMod objects — profile-methods"><meta property="og:description" content="Methods for profile() of [ng]lmer fitted
  models.
The log() method and the more flexible logProf()
  utility transform a lmer profile into one where logarithms of standard deviations
  are used, while varianceProf converts from the
  standard-deviation to the variance scale; see Details."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lme4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-35.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/lmerperf.html">lme4 performance tips</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lme4/lme4/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Profile method for merMod objects</h1>
      
      <div class="d-none name"><code>profile-methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Methods for <code><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></code>() of [ng]<code><a href="lmer.html">lmer</a></code> fitted
  models.</p>
<p>The <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log()</a></code> method and the more flexible <code>logProf()</code>
  utility transform a <code>lmer</code> profile into one where logarithms of standard deviations
  are used, while <code>varianceProf</code> converts from the
  standard-deviation to the variance scale; see Details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for merMod</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">fitted</span>, which <span class="op">=</span> <span class="cn">NULL</span>, alphamax <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  maxpts <span class="op">=</span> <span class="fl">100</span>, delta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    delta.cutoff <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">8</span>, verbose <span class="op">=</span> <span class="fl">0</span>, devtol <span class="op">=</span> <span class="fl">1e-09</span>,</span>
<span>    devmatchtol <span class="op">=</span> <span class="fl">1e-5</span>,</span>
<span>    maxmult <span class="op">=</span> <span class="fl">10</span>, startmethod <span class="op">=</span> <span class="st">"prev"</span>, optimizer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    control<span class="op">=</span><span class="cn">NULL</span>, signames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"multicore"</span>, <span class="st">"snow"</span><span class="op">)</span>,</span>
<span>    ncpus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"profile.ncpus"</span>, <span class="fl">1L</span><span class="op">)</span>, cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    prof.scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sdcor"</span>,<span class="st">"varcov"</span><span class="op">)</span>,</span>
<span>    <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for thpr</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span> <span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for thpr</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span>, base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">logProf</span><span class="op">(</span><span class="va">x</span>, base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, ranef <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           sigIni <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">ranef</span><span class="op">)</span> <span class="st">"sig"</span> <span class="kw">else</span> <span class="st">"sigma"</span><span class="op">)</span></span>
<span><span class="fu">varianceProf</span><span class="op">(</span><span class="va">x</span>, ranef <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>fitted</dt>
<dd><p>a fitted model, e.g., the result of <code><a href="lmer.html">lmer</a>(..)</code>.</p></dd>

  <dt>which</dt>
<dd><p>NULL value,
    integer or character vector indicating which parameters
    to profile: default (NULL) is all parameters.  For integer, i.e., indexing,
    the parameters are ordered as follows:</p><dl><dt>(1)</dt>
<dd><p>random effects (theta) parameters; these are ordered as
	in <code>getME(.,"theta")</code>, i.e., as the lower triangle of a
	matrix with standard deviations on the diagonal and correlations
	off the diagonal.</p></dd>

      <dt>(2)</dt>
<dd><p>residual standard deviation (or scale parameter for GLMMs
        where appropriate).</p></dd>

      <dt>(3)</dt>
<dd><p>fixed effect (beta) parameters.</p></dd>

    
</dl><p>Alternatively, <code>which</code> may be a character, containing
    <code>"beta_"</code> or <code>"theta_"</code> denoting the fixed or random
    effects parameters, respectively, or also containing parameter
    names, such as <code>".sigma"</code> or <code>"(Intercept)"</code>.</p></dd>

  <dt>alphamax</dt>
<dd><p>a number in \((0,1)\), such that <code>1 - alphamax</code>
    is the maximum alpha value for likelihood ratio confidence
    regions; used to establish the range of values to be profiled.</p></dd>

  <dt>maxpts</dt>
<dd><p>maximum number of points (in each direction, for each
    parameter) to evaluate in attempting to construct the profile.</p></dd>

  <dt>delta</dt>
<dd><p>stepping scale for deciding on next point to profile.
    The code uses the local derivative of the profile at the current
    step to establish a change in the focal parameter that will lead
    to a step of <code>delta</code> on the square-root-deviance scale.
    If <code>NULL</code>, the <code>delta.cutoff</code> parameter will be used
    to determine the stepping scale.</p></dd>

  <dt>delta.cutoff</dt>
<dd><p>stepping scale (see <code>delta</code>)
    expressed as a fraction of the
    target maximum value of the profile on the square-root-deviance
    scale.  Thus a <code>delta.cutoff</code> setting of <code>1/n</code> will
    lead to a profile with approximately <code>2*n</code> calculated points
    for each parameter (i.e., <code>n</code> points in each direction,
    below and above the estimate for each parameter).</p></dd>

  <dt>verbose</dt>
<dd><p>level of output from internal calculations.</p></dd>

  <dt>devtol</dt>
<dd><p>tolerance for fitted deviances less than
    baseline (supposedly minimum) deviance.</p></dd>

  <dt>devmatchtol</dt>
<dd><p>tolerance for match between original deviance
    computation and value returned from auxiliary deviance function</p></dd>

  <dt>maxmult</dt>
<dd><p>maximum multiplier of the original step size allowed,
    defaults to 10.</p></dd>

  <dt>startmethod</dt>
<dd><p>method for picking starting conditions for
    optimization (STUB).</p></dd>

  <dt>optimizer</dt>
<dd><p>(character or function) optimizer to use (see
    <code><a href="lmer.html">lmer</a></code> for details); default is to use the optimizer
    from the original model fit.</p></dd>

  <dt>control</dt>
<dd><p>a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> of options controlling the
    profiling (see <code><a href="lmerControl.html">lmerControl</a></code>): default is to use the
    control settings from the original model fit.</p></dd>

  <dt>signames</dt>
<dd><p>logical indicating if abbreviated names of the form
    <code>.sigNN</code> should be used; otherwise, names are more meaningful
    (but longer) of the form <code>(sd|cor)_(effects)|(group)</code>.  Note
    that some code for profile transformations (e.g., <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log()</a></code> or
    <code>varianceProf</code>) depends on <code>signames==TRUE</code>.</p></dd>

  <dt>...</dt>
<dd><p>potential further arguments for various methods.</p></dd>

  <dt>x</dt>
<dd><p>an object of class <code>thpr</code> (i.e., output of
    <code>profile</code>)</p></dd>

  <dt>base</dt>
<dd><p>the base of the logarithm.  Defaults to natural
    logarithms.</p></dd>

  <dt>ranef</dt>
<dd><p>logical indicating if the sigmas of the random effects
    should be <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log()</a></code> transformed as well.  If false, only
    \(\sigma\) (standard deviation of errors) is transformed.</p></dd>

  <dt>sigIni</dt>
<dd><p>character string specifying the initial part of the
    sigma parameters to be log transformed.</p></dd>

  <dt>parallel</dt>
<dd><p>The type of parallel operation to be used (if any).
    If missing, the
    default is taken from the option <code>"profile.parallel"</code> (and if that
    is not set, <code>"no"</code>).</p></dd>

  <dt>ncpus</dt>
<dd><p>integer: number of processes to be used in parallel operation:
    typically one would choose this to be the number of available CPUs.</p></dd>

  <dt>cl</dt>
<dd><p>An optional <span class="pkg">parallel</span> or <span class="pkg">snow</span> cluster for use if
    <code>parallel = "snow"</code>.  If not supplied, a cluster on the
    local machine is created for the duration of the <code>profile</code>
    call.</p></dd>

  <dt>prof.scale</dt>
<dd><p>whether to profile on the standard
    deviation-correlation scale (<code>"sdcor"</code>) or on
    the variance-covariance scale (<code>"varcov"</code>)</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<p><code>profile(&lt;merMod&gt;)</code> returns an object of S3 class</p>
<p></p>
<p><code>"thpr"</code>, <!-- %% = th[eta] pr[ofile], now a misnomer, as we also profile beta's --></p>


<p>which is <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>-like.
  Notable methods for such a profile object</p>
<p></p>
<p><code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a>()</code>, which returns the
  confidence intervals based on the profile,
  and three plotting methods
  (which require the <span class="pkg">lattice</span> package),</p>
<p></p>
<p><code><a href="plots.thpr.html">xyplot</a></code>, <code>densityplot</code>, and</p>
<p></p>
<p><code>splom</code>.</p>


<p>In addition, the</p>
<p></p>
<p><code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a>()</code> (see above) and <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a>()</code></p>


<p>methods can transform <code>"thpr"</code> objects in useful ways.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></code> method and the more flexible <code>logProf()</code>
  function transform the profile into one where \(\log(\sigma)\) is
  used instead of \(\sigma\).
  By default all sigmas including the standard deviations of the random
  effects are transformed i.e., the methods return a profile with all
  of the <code>.sigNN</code>
  parameters replaced by <code>.lsigNN</code>.  If <code>ranef</code> is false, only
  <code>".sigma"</code>, the standard deviation of the errors, is transformed
  (as it should never be zero, whereas random effect standard
  deviations (<code>.sigNN</code>) can be reasonably be zero).
  <br>
  The forward and backward splines for the log-transformed parameters
  are recalculated.
  Note that correlation parameters are not handled sensibly at present
  (i.e., they are logged rather than taking a more applicable
  transformation such as an arc-hyperbolic tangent,
  <code>atanh(x)</code>=\(\log((1+x)/(1-x))/2\)).</p>
<p>The <code>varianceProf</code> function works similarly, including
  non-sensibility for correlation parameters, by squaring all
  parameter values, changing the names by appending <code>sq</code>
  appropriately (e.g. <code>.sigNN</code> to <code>.sigsqNN</code>).
  Setting <code>prof.scale="varcov"</code> in the original
  <code><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile()</a></code> call is a more computationally
  intensive, but more correct, way to compute confidence
  intervals for covariance parameters.</p>
<p>Methods for function <code><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></code> (package
  <span class="pkg">stats</span>), here for profiling (fitted) mixed effect models.</p>
<p><!-- %% FIXME: ../inst/doc/profiling.txt  contains  motivation and more by -->
<!-- %% Doug Bates. Should add here (partly), or "link to there". --></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The plotting methods <code><a href="plots.thpr.html">xyplot</a></code> etc, for class
  <code>"thpr"</code>.</p>
<p>For (more expensive) alternative confidence intervals:
  <code><a href="bootMer.html">bootMer</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fm01ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="lmer.html">lmer</a></span><span class="op">(</span><span class="va">Yield</span> <span class="op">~</span> <span class="fl">1</span><span class="op">|</span><span class="va">Batch</span>, <span class="va">Dyestuff</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tpr</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">fm01ML</span>, optimizer<span class="op">=</span><span class="st">"Nelder_Mead"</span>, which<span class="op">=</span><span class="st">"beta_"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="co">## fast; as only *one* beta parameter is profiled over -&gt; 0.09s (2022)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.08    0.00    0.23 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## full profiling (default which means 'all') needs longer:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span> <span class="va">tpr</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">fm01ML</span>, signames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.35    0.00    0.81 </span>
<span class="r-in"><span><span class="co">## ~ 0.26s (2022) + possible warning about convergence</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">tpr</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">CIpr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           2.5 %     97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd_(Intercept)|Batch   12.19854   84.06305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma                  38.22998   67.65770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          1486.45150 1568.54849</span>
<span class="r-in"><span><span class="co"># too much precision (etc). but just FYI:</span></span></span>
<span class="r-in"><span> <span class="va">trgt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12.19854</span>, <span class="fl">38.22998</span>, <span class="fl">1486.451</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">84.06305</span>, <span class="fl">67.6577</span>,  <span class="fl">1568.548</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">trgt</span>, <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">CIpr</span><span class="op">)</span>, tol <span class="op">=</span> <span class="fl">.0001</span><span class="op">)</span><span class="op">)</span> <span class="co"># had 3.1e-7</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://lattice.r-forge.r-project.org/" class="external-link">"lattice"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">tpr</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">tpr</span>, absVal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># easier to see conf.int.s (and check symmetry)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">tpr</span>, conf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.99</span><span class="op">)</span>, <span class="co"># (instead of all five 50, 80,...)</span></span></span>
<span class="r-in"><span>        main <span class="op">=</span> <span class="st">"95% and 99% profile() intervals"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="fu">logProf</span><span class="op">(</span><span class="va">tpr</span>, ranef<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"lmer profile()s"</span><span class="op">~</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span><span class="op">*</span><span class="st">" (only log)"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html" class="external-link">densityplot</a></span><span class="op">(</span><span class="va">tpr</span>, main<span class="op">=</span><span class="st">"densityplot( profile(lmer(..)) )"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html" class="external-link">densityplot</a></span><span class="op">(</span><span class="fu">varianceProf</span><span class="op">(</span><span class="va">tpr</span><span class="op">)</span>, main<span class="op">=</span><span class="st">" varianceProf( profile(lmer(..)) )"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/splom.html" class="external-link">splom</a></span><span class="op">(</span><span class="va">tpr</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/splom.html" class="external-link">splom</a></span><span class="op">(</span><span class="fu">logProf</span><span class="op">(</span><span class="va">tpr</span>, ranef<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">doMore</span> <span class="op">&lt;-</span> <span class="fu">lme4</span><span class="fu">:::</span><span class="fu">testLevel</span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span> </span></span>
<span class="r-in"><span> <span class="kw">if</span><span class="op">(</span><span class="va">doMore</span><span class="op">)</span> <span class="op">{</span> <span class="co">## not typically, for time constraint reasons</span></span></span>
<span class="r-in"><span>   <span class="co">## Batch and residual variance only</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">tpr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">fm01ML</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># , optimizer="Nelder_Mead" gives warning</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">tpr2</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">tpr2</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="co"># log(sigma) is better</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="fu">logProf</span><span class="op">(</span><span class="va">tpr2</span>, ranef<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## GLMM example</span></span></span>
<span class="r-in"><span>   <span class="va">gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="glmer.html">glmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">incidence</span>, <span class="va">size</span> <span class="op">-</span> <span class="va">incidence</span><span class="op">)</span> <span class="op">~</span> <span class="va">period</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">herd</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               data <span class="op">=</span> <span class="va">cbpp</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="co">## running ~ 10 seconds on a modern machine {-&gt; "verbose" while you wait}:</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">pr4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">gm1</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">pr4</span>, layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span>, as.table<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">pr4</span><span class="op">)</span>, absVal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span> <span class="co"># log(sigma_1)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/splom.html" class="external-link">splom</a></span><span class="op">(</span><span class="va">pr4</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span> <span class="co"># quicker: only sig01 and one fixed effect</span></span></span>
<span class="r-in"><span>       <span class="va">pr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">gm1</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"theta_"</span>, <span class="st">"period2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">pr2</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="co">## delta..: higher underlying resolution, only for 'sigma_1':</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>       <span class="va">pr4.hr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">gm1</span>, which<span class="op">=</span><span class="st">"theta_"</span>, delta.cutoff<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">pr4.hr</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># only if interactive()</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Douglas Bates, Martin Maechler, Ben Bolker, Steven Walker.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

